var Experience=function e(){var e={},n=0,o=$("#content"),t,i,a=17,r=[0,0,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],c;return e.init=function(){e.goToStage(0),$(".next").click(function(){e.nextStage()}),$(".back").click(function(){e.prevStage()}),$(document).keydown(function(n){return 37===n.keyCode?(e.prevStage(),!1):void 0}),$(document).keydown(function(n){return 39===n.keyCode?(e.nextStage(),!1):void 0})},e.setUserQuote=function(e){c=e},e.getUserQuote=function(){return c},e.getImage=function(){return i},e.getSlideTime=function(){var e=1e3*r[n];return console.log(e+" m/seconds for slide number "+n),e},e.goToStage=function(e){var t=e;o.transition({opacity:"0"},300,"easeInSine").promise().done(function(){"undefined"!=typeof slideTimer&&clearInterval(slideTimer),o.load("stages/"+e+".php",function(){console.log("loading "+e+".php"),o.transition({opacity:"1"},300,"easeInSine")})}),n=t},e.nextStage=function(){if(console.log("next"),a-1>=n){console.log("current stage; "+n);var o=n+1;console.log("new stage; "+o),e.goToStage(o)}else console.log("cancelling"),clearInterval(slideTimer)},e.prevStage=function(){e.goToStage(n-1)},e.photoInit=function(){function e(e){video.src=window.URL.createObjectURL(e),localMediaStream=e}function n(e){console.log(e)}video.addEventListener("click",snapshot,!1),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,navigator.getUserMedia&&navigator.getUserMedia(hdConstraints,e,n)},e.startCountdown=function(){var n=3;t=setInterval(function(){$(".number").transition({scale:1,opacity:1},0),$(".countdown-container").css({opacity:1}),0===n&&(e.stopCountdown(),e.takePhoto(),e.showPreview()),console.log(n),$(".number").html(n),$(".number").transition({scale:0,opacity:0},1e3).promise().done(function(){}),n-=1},1e3)},e.takePhoto=function(){localMediaStream&&(ctx.drawImage(video,0,0),i=canvas.toDataURL("image/webp"),console.log(i))},e.showPreview=function(){$(".photo-preview").css({opacity:0}),$(".confirm-panel").show()},e.stopCountdown=function(){$(".countdown-container").css({opacity:0}),clearInterval(t)},e};